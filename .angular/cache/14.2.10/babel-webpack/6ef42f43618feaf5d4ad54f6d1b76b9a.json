{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/WM/Documents/GitHub/desafio-angular-codigo-do-futuro/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Carrinho } from 'src/app/servicos/carrinho';\nimport { ClienteServico } from 'src/app/servicos/clienteServico';\nimport { PedidoProdutoServico } from 'src/app/servicos/pedidoProdutoServico';\nimport { ProdutoServico } from 'src/app/servicos/produtoServico';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\n\nfunction CarrinhoComponent_select_3_option_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 7)(1, \"div\", 8);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const cliente_r5 = ctx.$implicit;\n    const i_r6 = ctx.index;\n    i0.ɵɵpropertyInterpolate(\"id\", cliente_r5.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r6 + 1 + \" - \" + cliente_r5.nome);\n  }\n}\n\nfunction CarrinhoComponent_select_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"select\", 5);\n    i0.ɵɵlistener(\"ngModelChange\", function CarrinhoComponent_select_3_Template_select_ngModelChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.cliente = $event);\n    });\n    i0.ɵɵtemplate(1, CarrinhoComponent_select_3_option_1_Template, 3, 2, \"option\", 6);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.cliente);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.clientes);\n  }\n}\n\nfunction CarrinhoComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"h3\");\n    i0.ɵɵtext(2, \"Resumo do pedido \");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction CarrinhoComponent_table_5_tr_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\", 13);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\")(9, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function CarrinhoComponent_table_5_tr_14_Template_button_click_9_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r13);\n      const i_r11 = restoredCtx.index;\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.Adicionar(i_r11));\n    });\n    i0.ɵɵtext(10, \"+\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11);\n    i0.ɵɵelementStart(12, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function CarrinhoComponent_table_5_tr_14_Template_button_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r13);\n      const i_r11 = restoredCtx.index;\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r14.Subtrair(i_r11));\n    });\n    i0.ɵɵtext(13, \"-\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"td\");\n    i0.ɵɵtext(15);\n    i0.ɵɵpipe(16, \"currency\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const item_r10 = ctx.$implicit;\n    const i_r11 = ctx.index;\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r10.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r9.nomes.at(i_r11));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(7, 5, ctx_r9.number(item_r10.valor)));\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", item_r10.quantidade, \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(16, 7, ctx_r9.multiplicacao(item_r10.quantidade, item_r10.valor)));\n  }\n}\n\nfunction CarrinhoComponent_table_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"table\", 10)(1, \"thead\")(2, \"tr\")(3, \"th\", 11);\n    i0.ɵɵtext(4, \"Id\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\", 11);\n    i0.ɵɵtext(6, \"Nome Produto\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\", 11);\n    i0.ɵɵtext(8, \"Valor\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\", 11);\n    i0.ɵɵtext(10, \"Quantidade\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\", 11);\n    i0.ɵɵtext(12, \"Total\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(13, \"tbody\");\n    i0.ɵɵtemplate(14, CarrinhoComponent_table_5_tr_14_Template, 17, 9, \"tr\", 12);\n    i0.ɵɵelementStart(15, \"tr\");\n    i0.ɵɵelement(16, \"th\", 13)(17, \"td\")(18, \"td\")(19, \"td\");\n    i0.ɵɵelementStart(20, \"td\")(21, \"p\");\n    i0.ɵɵtext(22);\n    i0.ɵɵpipe(23, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function CarrinhoComponent_table_5_Template_button_click_24_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.salvar());\n    });\n    i0.ɵɵtext(25, \"Comprar\");\n    i0.ɵɵelementEnd()()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(14);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.items);\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(23, 2, ctx_r2.number(ctx_r2.valor_total)));\n  }\n}\n\nfunction CarrinhoComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17)(1, \"h3\", 18);\n    i0.ɵɵtext(2, \"O Carrinho est\\u00E1 vazio\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nexport class CarrinhoComponent {\n  constructor(http, router) {\n    this.http = http;\n    this.router = router;\n    this.items = [];\n    this.nomes = [];\n    this.clientes = [];\n    this.produtoServico = {};\n    this.pedidoProdutoServico = {};\n    this.clienteServico = {};\n    this.valor_total = 0;\n    this.cliente = \"1\";\n  }\n\n  ngOnInit() {\n    this.produtoServico = new ProdutoServico(this.http);\n    this.pedidoProdutoServico = new PedidoProdutoServico(this.http);\n    this.clienteServico = new ClienteServico(this.http);\n    this.listaItems();\n    this.calcularValorTotal();\n  }\n\n  listaItems() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.items = Carrinho.listar();\n      let clientes = yield _this.clienteServico.lista();\n\n      if (!clientes) {} else {\n        _this.clientes = clientes;\n      }\n\n      _this.items?.forEach( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (item) {\n          let nome = yield _this.produtoServico.buscaPorId(item.produto_id);\n\n          if (!nome) {} else {\n            _this.nomes.push(nome.nome);\n          }\n        });\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  salvar() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      Carrinho.setCliente_Id(_this2.clientes[Number(_this2.cliente?.split(\"-\")[0].split(\" \")[0]) - 1].id);\n      yield Carrinho.salvar(_this2.http);\n      Carrinho.reset();\n    })();\n  }\n\n  convert(id) {\n    console.log(id);\n    return Number(id);\n  }\n\n  Excluir(id) {\n    Carrinho.excluirProduto(id);\n    this.calcularValorTotal();\n  }\n\n  multiplicacao(a, b) {\n    return Number(a) * Number(b);\n  }\n\n  calcularValorTotal() {\n    this.valor_total = Carrinho.getValor_Total();\n  }\n\n  Subtrair(id) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      let itemE = {};\n\n      for (let i = 0; i < _this3.items.length; i++) {\n        if (i == id) {\n          itemE = _this3.items[i];\n        }\n      }\n\n      let qtd = itemE.quantidade;\n      let quantidade = 0;\n\n      if (qtd) {\n        quantidade = Number(qtd);\n      }\n\n      if (quantidade-- > 1) {\n        _this3.items?.forEach(item => {\n          if (item.id === itemE.id) {\n            item.quantidade = new Number(quantidade--);\n          }\n        });\n\n        _this3.calcularValorTotal();\n      } else {\n        _this3.Excluir(id);\n      }\n    })();\n  }\n\n  Adicionar(id) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      let itemE = {};\n\n      for (let i = 0; i < _this4.items.length; i++) {\n        if (i == id) {\n          itemE = _this4.items[i];\n        }\n      }\n\n      let limiteSuperior = 0;\n      let limite = (yield new ProdutoServico(_this4.http).buscaPorId(itemE.produto_id))?.qtd_estoque;\n\n      if (limite) {\n        limiteSuperior = Number(limite);\n      }\n\n      let qtd = itemE.quantidade;\n      let quantidade = 0;\n\n      if (qtd) {\n        quantidade = Number(qtd);\n      }\n\n      if (limiteSuperior > quantidade++) {\n        console.log(limiteSuperior);\n        _this4.items?.forEach(item => {\n          if (item.id === itemE.id) {\n            item.quantidade = new Number(quantidade++);\n          }\n        });\n\n        _this4.calcularValorTotal();\n      }\n    })();\n  }\n\n  number(a) {\n    return Number(a);\n  }\n\n}\n\nCarrinhoComponent.ɵfac = function CarrinhoComponent_Factory(t) {\n  return new (t || CarrinhoComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.Router));\n};\n\nCarrinhoComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CarrinhoComponent,\n  selectors: [[\"app-carrinho\"]],\n  decls: 7,\n  vars: 4,\n  consts: [[1, \"container-total\"], [\"id\", \"required\", \"data-placeholder\", \"CPF - Nome do cliente\", 3, \"ngModel\", \"ngModelChange\", 4, \"ngIf\"], [\"class\", \"resu\", 4, \"ngIf\"], [\"class\", \"table table-hover\", 4, \"ngIf\"], [\"class\", \"para\", 4, \"ngIf\"], [\"id\", \"required\", \"data-placeholder\", \"CPF - Nome do cliente\", 3, \"ngModel\", \"ngModelChange\"], [3, \"id\", 4, \"ngFor\", \"ngForOf\"], [3, \"id\"], [\"id\", \"\"], [1, \"resu\"], [1, \"table\", \"table-hover\"], [\"scope\", \"col\"], [4, \"ngFor\", \"ngForOf\"], [\"scope\", \"row\"], [\"id\", \"proximo\", \"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"id\", \"adicionar\", \"type\", \"button\", 1, \"btn\", \"btn-primary\", 2, \"margin-right\", \"10px\", 3, \"click\"], [\"id\", \"retirar\", \"type\", \"button\", 1, \"btn\", \"btn-danger\", 2, \"margin-left\", \"10px\", 3, \"click\"], [1, \"para\"], [1, \"para1\"]],\n  template: function CarrinhoComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\");\n      i0.ɵɵtext(2, \"MEU CARRINHO\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(3, CarrinhoComponent_select_3_Template, 2, 2, \"select\", 1);\n      i0.ɵɵtemplate(4, CarrinhoComponent_div_4_Template, 3, 0, \"div\", 2);\n      i0.ɵɵtemplate(5, CarrinhoComponent_table_5_Template, 26, 4, \"table\", 3);\n      i0.ɵɵtemplate(6, CarrinhoComponent_div_6_Template, 3, 0, \"div\", 4);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.items.length > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.items.length > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.items.length > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.items.length == 0);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgModel, i3.CurrencyPipe],\n  styles: [\".container-total[_ngcontent-%COMP%]{\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    flex-wrap: nowrap;\\r\\n    align-content: center;\\r\\n    justify-content: center;\\r\\n    padding-right: 10px;\\r\\n    padding-left: 10px;\\r\\n    margin-top: 10px;\\r\\n}\\r\\n\\r\\nselect[_ngcontent-%COMP%]{\\r\\n    margin-bottom: 10px;\\r\\n}\\r\\n\\r\\n.table[_ngcontent-%COMP%]{\\r\\n    width: 750px;\\r\\n    align-self: end;\\r\\n    border-style:inset;\\r\\n    text-align-last: center;\\r\\n    background: #f8f8f8;\\r\\n    margin-bottom: 70px;\\r\\n}\\r\\n\\r\\ntr[_ngcontent-%COMP%]{\\r\\n    border-style: dotted;\\r\\n    border-width: 0;\\r\\n}\\r\\n\\r\\n.form-control[_ngcontent-%COMP%]{\\r\\n    visibility: hidden;}\\r\\n\\r\\n.resu[_ngcontent-%COMP%]{\\r\\n    align-self: end;\\r\\n    border-style:inset;\\r\\n    text-align-last: center;\\r\\n    width: 750px;\\r\\n    background: #f8f8f8;\\r\\n    border-top-left-radius: 0.5rem;\\r\\n    border-top-right-radius: 0.5rem;\\r\\n}\\r\\n\\r\\n.para1[_ngcontent-%COMP%]{\\r\\n    padding-top: 15px;\\r\\n    text-align: center;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcnJpbmhvLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxhQUFhO0lBQ2Isc0JBQXNCO0lBQ3RCLGlCQUFpQjtJQUNqQixxQkFBcUI7SUFDckIsdUJBQXVCO0lBQ3ZCLG1CQUFtQjtJQUNuQixrQkFBa0I7SUFDbEIsZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0ksbUJBQW1CO0FBQ3ZCOztBQUVBO0lBQ0ksWUFBWTtJQUNaLGVBQWU7SUFDZixrQkFBa0I7SUFDbEIsdUJBQXVCO0lBQ3ZCLG1CQUFtQjtJQUNuQixtQkFBbUI7QUFDdkI7O0FBRUE7SUFDSSxvQkFBb0I7SUFDcEIsZUFBZTtBQUNuQjs7QUFFQTtJQUNJLGtCQUFrQixDQUFDOztBQUV2QjtJQUNJLGVBQWU7SUFDZixrQkFBa0I7SUFDbEIsdUJBQXVCO0lBQ3ZCLFlBQVk7SUFDWixtQkFBbUI7SUFDbkIsOEJBQThCO0lBQzlCLCtCQUErQjtBQUNuQzs7QUFFQTtJQUNJLGlCQUFpQjtJQUNqQixrQkFBa0I7QUFDdEIiLCJmaWxlIjoiY2FycmluaG8uY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5jb250YWluZXItdG90YWx7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgIGZsZXgtd3JhcDogbm93cmFwO1xyXG4gICAgYWxpZ24tY29udGVudDogY2VudGVyO1xyXG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgICBwYWRkaW5nLXJpZ2h0OiAxMHB4O1xyXG4gICAgcGFkZGluZy1sZWZ0OiAxMHB4O1xyXG4gICAgbWFyZ2luLXRvcDogMTBweDtcclxufVxyXG5cclxuc2VsZWN0e1xyXG4gICAgbWFyZ2luLWJvdHRvbTogMTBweDtcclxufVxyXG5cclxuLnRhYmxle1xyXG4gICAgd2lkdGg6IDc1MHB4O1xyXG4gICAgYWxpZ24tc2VsZjogZW5kO1xyXG4gICAgYm9yZGVyLXN0eWxlOmluc2V0O1xyXG4gICAgdGV4dC1hbGlnbi1sYXN0OiBjZW50ZXI7XHJcbiAgICBiYWNrZ3JvdW5kOiAjZjhmOGY4O1xyXG4gICAgbWFyZ2luLWJvdHRvbTogNzBweDtcclxufVxyXG5cclxudHJ7XHJcbiAgICBib3JkZXItc3R5bGU6IGRvdHRlZDtcclxuICAgIGJvcmRlci13aWR0aDogMDtcclxufVxyXG5cclxuLmZvcm0tY29udHJvbHtcclxuICAgIHZpc2liaWxpdHk6IGhpZGRlbjt9XHJcblxyXG4ucmVzdXtcclxuICAgIGFsaWduLXNlbGY6IGVuZDtcclxuICAgIGJvcmRlci1zdHlsZTppbnNldDtcclxuICAgIHRleHQtYWxpZ24tbGFzdDogY2VudGVyO1xyXG4gICAgd2lkdGg6IDc1MHB4O1xyXG4gICAgYmFja2dyb3VuZDogI2Y4ZjhmODtcclxuICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDAuNXJlbTtcclxuICAgIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiAwLjVyZW07XHJcbn1cclxuXHJcbi5wYXJhMXtcclxuICAgIHBhZGRpbmctdG9wOiAxNXB4O1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG59XHJcblxyXG4iXX0= */\"]\n});","map":{"version":3,"mappings":"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","names":["Carrinho","ClienteServico","PedidoProdutoServico","ProdutoServico","i0","CarrinhoComponent","constructor","http","router","ngOnInit","produtoServico","pedidoProdutoServico","clienteServico","listaItems","calcularValorTotal","items","listar","clientes","lista","forEach","item","nome","buscaPorId","produto_id","nomes","push","salvar","setCliente_Id","Number","cliente","split","id","reset","convert","console","log","Excluir","excluirProduto","multiplicacao","a","b","valor_total","getValor_Total","Subtrair","itemE","i","length","qtd","quantidade","Adicionar","limiteSuperior","limite","qtd_estoque","number","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\WM\\Documents\\GitHub\\desafio-angular-codigo-do-futuro\\src\\app\\pages\\carrinho\\carrinho.component.ts","C:\\Users\\WM\\Documents\\GitHub\\desafio-angular-codigo-do-futuro\\src\\app\\pages\\carrinho\\carrinho.component.html"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { Cliente } from 'src/app/models/cliente';\r\nimport { PedidoProduto } from 'src/app/models/pedidoProduto';\r\nimport { Carrinho } from 'src/app/servicos/carrinho';\r\nimport { ClienteServico } from 'src/app/servicos/clienteServico';\r\nimport { PedidoProdutoServico } from 'src/app/servicos/pedidoProdutoServico';\r\nimport { ProdutoServico } from 'src/app/servicos/produtoServico';\r\n\r\n@Component({\r\n  selector: 'app-carrinho',\r\n  templateUrl: './carrinho.component.html',\r\n  styleUrls: ['./carrinho.component.css']\r\n})\r\nexport class CarrinhoComponent implements OnInit {\r\n\r\n  public items:  (PedidoProduto)[]=[];\r\n  public nomes:String[]=[]\r\n  public clientes: (Cliente)[]=[];\r\n  public produtoServico:ProdutoServico= {} as ProdutoServico;\r\n  public pedidoProdutoServico:PedidoProdutoServico= {} as PedidoProdutoServico;\r\n  public clienteServico:ClienteServico= {} as ClienteServico;\r\n  public valor_total:Number=0;\r\n  public cliente: String | undefined=\"1\";\r\n  constructor(\r\n    private http:HttpClient,\r\n    private router:Router,\r\n  ) { }\r\n  \r\n  ngOnInit(): void {\r\n    this.produtoServico = new ProdutoServico(this.http);\r\n    this.pedidoProdutoServico = new PedidoProdutoServico(this.http);\r\n    this.clienteServico = new ClienteServico(this.http);\r\n    this.listaItems();\r\n    this.calcularValorTotal()\r\n  }\r\n\r\n  private async listaItems() {\r\n    this.items = Carrinho.listar();\r\n    let clientes= await this.clienteServico.lista();\r\n    if(!clientes){\r\n        \r\n    }else{\r\n      this.clientes= clientes\r\n    }\r\n    this.items?.forEach(async item =>{\r\n      let nome = await this.produtoServico.buscaPorId(item.produto_id);\r\n      if(!nome){}else{\r\n        this.nomes.push(nome.nome);\r\n      }\r\n    });\r\n  }\r\n\r\n  public async salvar() {\r\n    Carrinho.setCliente_Id(this.clientes[Number(this.cliente?.split(\"-\")[0].split(\" \")[0])-1].id);\r\n    await Carrinho.salvar(this.http);\r\n    Carrinho.reset();\r\n  }\r\n\r\n  public convert(id:Number):number{\r\n    console.log(id);\r\n    return Number(id);\r\n  }\r\n\r\n  Excluir(id:number){\r\n    Carrinho.excluirProduto(id);\r\n    this.calcularValorTotal();\r\n  }\r\n\r\n  multiplicacao(a:Number,b:Number):number{\r\n    return Number(a)*Number(b)\r\n  }\r\n\r\n  calcularValorTotal() {\r\n    this.valor_total=Carrinho.getValor_Total();\r\n  }\r\n  \r\n  async Subtrair(id:number){\r\n    let itemE:PedidoProduto={} as PedidoProduto;\r\n    for (let i = 0; i < this.items.length; i++) {\r\n      if(i==id){\r\n        itemE = this.items[i];\r\n      }\r\n    }\r\n    let qtd=itemE.quantidade;\r\n    let quantidade=0;\r\n    if(qtd){\r\n      quantidade=Number(qtd);\r\n    }\r\n    if((quantidade--)>1){\r\n      this.items?.forEach(item=>{\r\n        if(item.id===itemE.id){\r\n          item.quantidade=new Number(quantidade--)\r\n        }\r\n      })\r\n      this.calcularValorTotal();\r\n    }else{\r\n      this.Excluir(id)\r\n    }\r\n  }\r\n  async Adicionar(id:number){\r\n    let itemE:PedidoProduto={} as PedidoProduto;\r\n    for (let i = 0; i < this.items.length; i++) {\r\n      if(i==id){\r\n        itemE = this.items[i];\r\n      }\r\n    }\r\n    let limiteSuperior=0;\r\n    let limite= (await new ProdutoServico(this.http).buscaPorId(itemE.produto_id))?.qtd_estoque\r\n    if(limite){\r\n      limiteSuperior=Number(limite);\r\n    }\r\n    let qtd=itemE.quantidade;\r\n    let quantidade=0;\r\n    if(qtd){\r\n      quantidade=Number(qtd);\r\n    }\r\n    if(limiteSuperior>quantidade++){\r\n      console.log(limiteSuperior)\r\n      this.items?.forEach(item=>{\r\n        if(item.id===itemE.id){\r\n          item.quantidade=new Number(quantidade++);\r\n        }\r\n      })\r\n      this.calcularValorTotal();\r\n    }\r\n  }\r\n  number (a : Number){\r\n    return Number(a)\r\n  }\r\n}\r\n\r\n\r\n","<div class=\"container-total\">\r\n  <h1>MEU CARRINHO</h1>\r\n  <select *ngIf=\"items.length>0\" id=\"required\" [(ngModel)]=\"cliente\"\r\n    data-placeholder=\"CPF - Nome do cliente\">\r\n    <option *ngFor=\"let cliente of clientes; index as i\" id=\"{{cliente.id}}\">\r\n      <div id>{{(i+1)+\" - \"+cliente.nome}}</div>\r\n    </option>\r\n  </select>\r\n  \r\n  <div class=\"resu\" *ngIf=\"items.length>0\"><h3>Resumo do pedido\r\n  </h3>\r\n  </div>\r\n  <table class=\"table table-hover\" *ngIf=\"items.length>0\">\r\n    \r\n    <thead>\r\n      <tr>\r\n        <th scope=\"col\">Id</th>\r\n        <th scope=\"col\">Nome Produto</th>\r\n        <th scope=\"col\">Valor</th>\r\n        <th scope=\"col\">Quantidade</th>\r\n        <th scope=\"col\">Total</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr *ngFor=\"let item of items;let i = index\">\r\n        <th scope=\"row\">{{item.id}}</th>\r\n        <td>{{nomes.at(i)}}</td>\r\n        <td>{{number(item.valor) | currency}}</td>\r\n        <td>\r\n          <button id=\"adicionar\" type=\"button\" class=\"btn btn-primary\" style=\"margin-right: 10px;\"\r\n            (click)=\"Adicionar(i)\">+</button>\r\n          {{item.quantidade}}\r\n          <button id=\"retirar\" type=\"button\" class=\"btn btn-danger\" style=\"margin-left: 10px;\"\r\n            (click)=\"Subtrair(i)\">-</button>\r\n        </td>\r\n        <td>{{multiplicacao(item.quantidade,item.valor) | currency}}</td>\r\n      </tr>\r\n      <tr>\r\n        <th scope=\"row\"></th>\r\n        <td></td>\r\n        <td></td>\r\n        <td></td>\r\n        <td>\r\n          <p>{{number(valor_total) | currency}}</p><button id=\"proximo\" type=\"submit\" class=\"btn btn-primary\"\r\n            (click)=\"salvar()\">Comprar</button>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n  <div class=\"para\" *ngIf=\"items.length==0\">\r\n    <h3 class=\"para1\">O Carrinho está vazio</h3>\r\n  </div>\r\n</div>"]},"metadata":{},"sourceType":"module"}