{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/WM/Documents/GitHub/desafio-angular-codigo-do-futuro/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { CategoriaServico } from 'src/app/servicos/categoriaServico';\nimport { PedidoProdutoServico } from 'src/app/servicos/pedidoProdutoServico';\nimport { PedidoServico } from 'src/app/servicos/pedidoServico';\nimport { ProdutoServico } from 'src/app/servicos/produtoServico';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\n\nfunction FormComprarProdutoComponent_form_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"form\", 4)(1, \"div\", 5)(2, \"label\", 6);\n    i0.ɵɵtext(3, \"Nome\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"input\", 7);\n    i0.ɵɵlistener(\"ngModelChange\", function FormComprarProdutoComponent_form_3_Template_input_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.produto.nome = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 5)(6, \"label\", 6);\n    i0.ɵɵtext(7, \"Descri\\u00E7\\u00E3o\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"input\", 8);\n    i0.ɵɵlistener(\"ngModelChange\", function FormComprarProdutoComponent_form_3_Template_input_ngModelChange_8_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.produto.descricao = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 5)(10, \"label\", 6);\n    i0.ɵɵtext(11, \"Quantidade\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"input\", 9);\n    i0.ɵɵlistener(\"ngModelChange\", function FormComprarProdutoComponent_form_3_Template_input_ngModelChange_12_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.produto.qtd_estoque = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"div\", 5)(14, \"label\", 6);\n    i0.ɵɵtext(15, \"Custo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"input\", 10);\n    i0.ɵɵlistener(\"ngModelChange\", function FormComprarProdutoComponent_form_3_Template_input_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.produto.custo = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"div\", 5)(18, \"label\", 6);\n    i0.ɵɵtext(19, \"Quantidade a ser comprada\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"input\", 11);\n    i0.ɵɵlistener(\"ngModelChange\", function FormComprarProdutoComponent_form_3_Template_input_ngModelChange_20_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.qtd = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(21, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function FormComprarProdutoComponent_form_3_Template_button_click_21_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.registrar());\n    });\n    i0.ɵɵtext(22, \"Comprar\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.produto.nome)(\"disabled\", true);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.produto.descricao)(\"disabled\", true);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.produto.qtd_estoque)(\"disabled\", true);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.produto.custo)(\"disabled\", true);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.qtd);\n  }\n}\n\nexport class FormComprarProdutoComponent {\n  constructor(router, http, routerParams) {\n    this.router = router;\n    this.http = http;\n    this.routerParams = routerParams;\n    this.categorias = [];\n    this.selecionado = [];\n    this.categoria_id = -1;\n    this.categoriaSelecionado = \"\";\n    this.qtd = 0;\n    this.produtoServico = {};\n    this.produto = {};\n    this.pedidoProdutoServico = {};\n    this.pedidoServico = {};\n  }\n\n  ngOnInit() {\n    this.produtoServico = new ProdutoServico(this.http);\n    this.pedidoServico = new PedidoServico(this.http);\n    this.pedidoProdutoServico = new PedidoProdutoServico(this.http);\n    let id = this.routerParams.snapshot.params['id'];\n\n    if (id) {\n      this.carregaProduto(id);\n    }\n\n    this.listaCategorias();\n  }\n\n  registrar() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      let produto_id = 0;\n      let qtd_estoque = 0;\n      let custo = 0;\n      let pedido = {};\n      pedido.cliente_id = 0;\n      if (_this.produto?.id) produto_id = _this.produto.id;\n      if (_this.qtd) qtd_estoque = _this.qtd;\n      if (_this.produto?.custo) custo = _this.produto.custo;\n      pedido.valor_total = -Number(qtd_estoque) * Number(custo);\n      yield _this.pedidoServico.criar(pedido);\n      let pedido_id = (yield _this.pedidoServico.getLast())?.id;\n\n      if (pedido_id) {\n        let pedidoProduto = {};\n        pedidoProduto.id = new Number(pedido_id + \"01\");\n        pedidoProduto.pedido_id = pedido_id;\n        pedidoProduto.produto_id = produto_id;\n        pedidoProduto.valor = -custo;\n        pedidoProduto.quantidade = -qtd_estoque;\n        yield _this.pedidoProdutoServico.criar(pedidoProduto);\n      }\n\n      _this.router.navigateByUrl(\"/produtos\");\n    })();\n  }\n\n  verificaUndefined() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      let produto_id = 0;\n      let qtd_estoque = 0;\n      let custo = 0;\n      let pedido = {};\n      pedido.cliente_id = 0;\n      if (_this2.produto?.id) produto_id = _this2.produto.id;\n      if (_this2.qtd) qtd_estoque = _this2.qtd;\n      if (_this2.produto?.custo) custo = _this2.produto.custo;\n      pedido.valor_total = -Number(qtd_estoque) * Number(custo);\n      yield _this2.pedidoServico.criar(pedido);\n      let pedido_id = (yield _this2.pedidoServico.getLast())?.id;\n\n      if (pedido_id) {\n        let pedidoProduto = {};\n        pedidoProduto.id = new Number(pedido_id + \"01\");\n        pedidoProduto.pedido_id = pedido_id;\n        pedidoProduto.produto_id = produto_id;\n        pedidoProduto.valor = -custo;\n        pedidoProduto.quantidade = qtd_estoque;\n        yield _this2.pedidoProdutoServico.criar(pedidoProduto);\n      }\n    })();\n  }\n\n  listaCategorias() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      let categorias = yield new CategoriaServico(_this3.http).lista();\n      categorias?.forEach(categoria => {\n        if (_this3.produto?.categoria_id && categoria.id.toString() === _this3.produto?.categoria_id.toString()) {\n          _this3.selecionado.push(true);\n        } else {\n          _this3.selecionado.push(false);\n        }\n\n        _this3.categorias.push(categoria);\n      });\n    })();\n  }\n\n  carregaProduto(id) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      _this4.produto = yield _this4.produtoServico.buscaPorId(id);\n      if (_this4.produto?.id) _this4.categoria_id = _this4.produto.id;\n      let categoria_id = _this4.produto?.categoria_id;\n      if (categoria_id) _this4.categoria_id = categoria_id;\n    })();\n  }\n\n  atualizaQuantidade(novaQtd) {\n    let qtdAtual = Number(this.produto?.qtd_estoque);\n    return Number(novaQtd) + qtdAtual;\n  }\n\n}\n\nFormComprarProdutoComponent.ɵfac = function FormComprarProdutoComponent_Factory(t) {\n  return new (t || FormComprarProdutoComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i1.ActivatedRoute));\n};\n\nFormComprarProdutoComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: FormComprarProdutoComponent,\n  selectors: [[\"app-form-comprar-produto\"]],\n  decls: 4,\n  vars: 1,\n  consts: [[\"id\", \"contact\", 1, \"page-section\", 2, \"margin-top\", \"10px\"], [1, \"container\"], [1, \"produt\", 2, \"width\", \"100%\"], [\"class\", \"form\", \"style\", \"display: flex;\", 4, \"ngIf\"], [1, \"form\", 2, \"display\", \"flex\"], [1, \"form-group\"], [\"for\", \"exampleInputEmail1\", 2, \"padding\", \"10px\"], [\"type\", \"text\", \"id\", \"nome-produto\", \"name\", \"nome-produto\", \"placeholder\", \"Insira o nome do produto\", 1, \"form-control\", 3, \"ngModel\", \"disabled\", \"ngModelChange\"], [\"type\", \"text\", \"id\", \"descricao-produto\", \"name\", \"descricao-produto\", \"placeholder\", \"Insira a descri\\u00E7\\u00E3o\", 1, \"form-control\", 3, \"ngModel\", \"disabled\", \"ngModelChange\"], [\"type\", \"text\", \"id\", \"quantidade-produto\", \"name\", \"quantidade-produto\", \"placeholder\", \"Insira a quantidade\", 1, \"form-control\", 3, \"ngModel\", \"disabled\", \"ngModelChange\"], [\"type\", \"text\", \"id\", \"custo-produto\", \"name\", \"custo-produto\", \"placeholder\", \"Insira a quantidade\", 1, \"form-control\", 3, \"ngModel\", \"disabled\", \"ngModelChange\"], [\"type\", \"text\", \"id\", \"novaQuantidade-produto\", \"name\", \"novaQuantidade-produto\", \"placeholder\", \"Insira a quantidade que ser\\u00E1 comprada\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"submitButton\", \"type\", \"button\", 1, \"btn\", \"btn-primary\", \"btn-xl\", \"m-3\", 3, \"click\"]],\n  template: function FormComprarProdutoComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"section\", 0)(1, \"div\", 1)(2, \"div\", 2);\n      i0.ɵɵtemplate(3, FormComprarProdutoComponent_form_3_Template, 23, 9, \"form\", 3);\n      i0.ɵɵelementEnd()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.produto);\n    }\n  },\n  dependencies: [i3.NgIf, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.NgModel, i4.NgForm],\n  styles: [\".page-section[_ngcontent-%COMP%]{\\r\\n    margin-top: 5px;\\r\\n    margin-bottom: 5px;\\r\\n}\\r\\n\\r\\n.produt[_ngcontent-%COMP%]{\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n.form[_ngcontent-%COMP%]{\\r\\n    display: flex;\\r\\n    flex-direction: row;\\r\\n    flex-wrap: wrap;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvcm0tY29tcHJhci1wcm9kdXRvLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxlQUFlO0lBQ2Ysa0JBQWtCO0FBQ3RCOztBQUVBO0lBQ0ksV0FBVztBQUNmOztBQUVBO0lBQ0ksYUFBYTtJQUNiLG1CQUFtQjtJQUNuQixlQUFlO0FBQ25CIiwiZmlsZSI6ImZvcm0tY29tcHJhci1wcm9kdXRvLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIucGFnZS1zZWN0aW9ue1xyXG4gICAgbWFyZ2luLXRvcDogNXB4O1xyXG4gICAgbWFyZ2luLWJvdHRvbTogNXB4O1xyXG59XHJcblxyXG4ucHJvZHV0e1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbn1cclxuXHJcbi5mb3Jte1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XHJcbiAgICBmbGV4LXdyYXA6IHdyYXA7XHJcbn0iXX0= */\"]\n});","map":{"version":3,"mappings":"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","names":["CategoriaServico","PedidoProdutoServico","PedidoServico","ProdutoServico","i0","FormComprarProdutoComponent","constructor","router","http","routerParams","ngOnInit","produtoServico","pedidoServico","pedidoProdutoServico","id","snapshot","params","carregaProduto","listaCategorias","registrar","produto_id","qtd_estoque","custo","pedido","cliente_id","produto","qtd","valor_total","Number","criar","pedido_id","getLast","pedidoProduto","valor","quantidade","navigateByUrl","verificaUndefined","categorias","lista","forEach","categoria","categoria_id","toString","selecionado","push","buscaPorId","atualizaQuantidade","novaQtd","qtdAtual","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\WM\\Documents\\GitHub\\desafio-angular-codigo-do-futuro\\src\\app\\pages\\form-comprar-produto\\form-comprar-produto.component.ts","C:\\Users\\WM\\Documents\\GitHub\\desafio-angular-codigo-do-futuro\\src\\app\\pages\\form-comprar-produto\\form-comprar-produto.component.html"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { Router, ActivatedRoute } from '@angular/router';\r\nimport { Categoria } from 'src/app/models/categoria';\r\nimport { Pedido } from 'src/app/models/pedido';\r\nimport { PedidoProduto } from 'src/app/models/pedidoProduto';\r\nimport { Produto } from 'src/app/models/produto';\r\nimport { CategoriaServico } from 'src/app/servicos/categoriaServico';\r\nimport { PedidoProdutoServico } from 'src/app/servicos/pedidoProdutoServico';\r\nimport { PedidoServico } from 'src/app/servicos/pedidoServico';\r\nimport { ProdutoServico } from 'src/app/servicos/produtoServico';\r\n\r\n@Component({\r\n  selector: 'app-form-comprar-produto',\r\n  templateUrl: './form-comprar-produto.component.html',\r\n  styleUrls: ['./form-comprar-produto.component.css']\r\n})\r\nexport class FormComprarProdutoComponent implements OnInit {\r\n\r\n  public categorias:Categoria[]=[];\r\n  public selecionado:boolean[]=[]\r\n  public categoria_id: Number=-1;\r\n  public categoriaSelecionado:String =\"\";\r\n  public qtd: Number = 0;\r\n\r\n  constructor(\r\n    private router:Router,\r\n    private http:HttpClient,\r\n    private routerParams:ActivatedRoute \r\n  ) { }\r\n\r\n  private produtoServico:ProdutoServico = {} as ProdutoServico;\r\n  public produto:Produto | undefined = {} as Produto;\r\n  public pedidoProdutoServico: PedidoProdutoServico = {} as PedidoProdutoServico; \r\n  public pedidoServico: PedidoServico = {} as PedidoServico; \r\n\r\n  ngOnInit(): void {\r\n    this.produtoServico = new ProdutoServico(this.http);\r\n    this.pedidoServico = new PedidoServico(this.http);\r\n    this.pedidoProdutoServico = new PedidoProdutoServico(this.http);\r\n    let id:Number = this.routerParams.snapshot.params['id'];\r\n    if(id){\r\n      this.carregaProduto(id);\r\n    }\r\n    this.listaCategorias();\r\n  }\r\n\r\n  async registrar(){\r\n    let produto_id: Number = 0\r\n    let qtd_estoque:Number = 0;\r\n    let custo:Number = 0;\r\n    let pedido = {} as Pedido;\r\n    \r\n    pedido.cliente_id = 0;\r\n    \r\n    if(this.produto?.id) produto_id = this.produto.id;\r\n    if(this.qtd) qtd_estoque = this.qtd;\r\n    if(this.produto?.custo) custo = this.produto.custo;\r\n\r\n    \r\n    pedido.valor_total =  - Number(qtd_estoque) * Number(custo);\r\n    await this.pedidoServico.criar(pedido);\r\n    let pedido_id = (await this.pedidoServico.getLast())?.id;\r\n\r\n    if(pedido_id){\r\n      let pedidoProduto = {} as PedidoProduto;\r\n      pedidoProduto.id = new Number (pedido_id+ \"01\");\r\n      pedidoProduto.pedido_id = pedido_id;\r\n      pedidoProduto.produto_id = produto_id;\r\n      pedidoProduto.valor = -custo;\r\n      pedidoProduto.quantidade = -qtd_estoque;\r\n      await this.pedidoProdutoServico.criar(pedidoProduto);\r\n    }\r\n    this.router.navigateByUrl(\"/produtos\");\r\n  }\r\n\r\n  async verificaUndefined(){\r\n    let produto_id: Number = 0\r\n    let qtd_estoque:Number = 0;\r\n    let custo:Number = 0;\r\n    let pedido = {} as Pedido;\r\n    \r\n    pedido.cliente_id = 0;\r\n    \r\n    if(this.produto?.id) produto_id = this.produto.id;\r\n    if(this.qtd) qtd_estoque = this.qtd;\r\n    if(this.produto?.custo) custo = this.produto.custo;\r\n\r\n    \r\n    pedido.valor_total =  - Number(qtd_estoque) * Number(custo);\r\n    await this.pedidoServico.criar(pedido);\r\n    let pedido_id = (await this.pedidoServico.getLast())?.id;\r\n\r\n    if(pedido_id){\r\n      let pedidoProduto = {} as PedidoProduto;\r\n      pedidoProduto.id = new Number (pedido_id+ \"01\");\r\n      pedidoProduto.pedido_id = pedido_id;\r\n      pedidoProduto.produto_id = produto_id;\r\n      pedidoProduto.valor = -custo;\r\n      pedidoProduto.quantidade = qtd_estoque;\r\n      await this.pedidoProdutoServico.criar(pedidoProduto);\r\n    }\r\n  }\r\n\r\n  private async listaCategorias(){\r\n    let categorias=await new CategoriaServico(this.http).lista();\r\n    categorias?.forEach(categoria => {\r\n      if(this.produto?.categoria_id&&categoria.id.toString()===this.produto?.categoria_id.toString()){\r\n        this.selecionado.push(true)\r\n        \r\n      }else{\r\n        this.selecionado.push(false)\r\n      }\r\n      this.categorias.push(categoria);\r\n    });\r\n  }\r\n\r\n  private async carregaProduto(id:Number){\r\n    this.produto = await this.produtoServico.buscaPorId(id);\r\n    if(this.produto?.id)this.categoria_id=this.produto.id;\r\n    let categoria_id=this.produto?.categoria_id;\r\n    if(categoria_id)this.categoria_id=categoria_id\r\n  }\r\n\r\n  private atualizaQuantidade(novaQtd : Number) : Number{\r\n    let qtdAtual = Number(this.produto?.qtd_estoque);\r\n    return Number(novaQtd) + qtdAtual\r\n  }\r\n}\r\n","<section class=\"page-section\" id=\"contact\" style=\"margin-top: 10px;\">\r\n    <div class=\"container\">\r\n        <div class=\"produt\" style=\"width: 100%\">\r\n            <form class=\"form\" *ngIf=\"produto\" style=\"display: flex;\">\r\n                <!--Feito apenas para puxar as informações do produto, nenhuma alteração será feita nesses dados-->\r\n                <div class=\"form-group\">\r\n                    <label for=\"exampleInputEmail1\" style=\"padding: 10px;\">Nome</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"nome-produto\" name=\"nome-produto\" [(ngModel)] = \"produto.nome\" placeholder=\"Insira o nome do produto\" [disabled]=\"true\">\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"exampleInputEmail1\" style=\"padding: 10px;\">Descrição</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"descricao-produto\" name=\"descricao-produto\" [(ngModel)] = \"produto.descricao\" placeholder=\"Insira a descrição\" [disabled]=\"true\">\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"exampleInputEmail1\" style=\"padding: 10px;\">Quantidade</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"quantidade-produto\" name=\"quantidade-produto\" [(ngModel)] = \"produto.qtd_estoque\" placeholder=\"Insira a quantidade\" [disabled]=\"true\">\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"exampleInputEmail1\" style=\"padding: 10px;\">Custo</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"custo-produto\" name=\"custo-produto\" [(ngModel)] = \"produto.custo\" placeholder=\"Insira a quantidade\" [disabled]=\"true\">\r\n                </div>\r\n\r\n                <!--Aqui é onde será feita a quantidade de itens para essa compra-->\r\n                <div class=\"form-group\">\r\n                    <label for=\"exampleInputEmail1\" style=\"padding: 10px;\">Quantidade a ser comprada</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"novaQuantidade-produto\" name=\"novaQuantidade-produto\" [(ngModel)] = \"qtd\" placeholder=\"Insira a quantidade que será comprada\">\r\n                </div>\r\n                \r\n                <button class=\"btn btn-primary btn-xl m-3\" id=\"submitButton\" (click)=\"registrar()\" type=\"button\">Comprar</button>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</section>\r\n"]},"metadata":{},"sourceType":"module"}